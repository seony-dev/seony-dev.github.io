---

layout: post  
title: "ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ì •ê·œì§êµí™”(Gram-Schmidt Orthonormalization)"  
description: >  
hide_last_modified: true  
categories: [study, math]  
tags: [Math, Linear Algebra, Unreal Engine]  
comments: true  
---

<p align="center">  
  <img src="/assets/img/blog/math/gram_schmidt.jpg" style="width: 832px; height: auto;" />  
</p>  
-----  

<span style="color:darkgray; font-size:13px;">ì´ë¯¸ì§€ ì¶œì²˜: https://en.wikipedia.org/wiki/Gramâ€“Schmidt_process</span>  

-----  

### ğŸ“ˆ ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ì •ê·œì§êµí™”ë€?

> **ì£¼ì–´ì§„ ì¼ì°¨ë…ë¦½ ë²¡í„° ì§‘í•©ì„ ì„œë¡œ ì§êµí•˜ê³  ì •ê·œí™”ëœ ë²¡í„° ì§‘í•©(ì •ê·œì§êµê¸°ì €)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ì„ í˜•ëŒ€ìˆ˜ ê¸°ë²•.**

ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ê³¼ì •ì€ ë²¡í„° ê³µê°„ì—ì„œ **ì •ê·œì§êµ ê¸°ì €(orthonormal basis)** ë¥¼ êµ¬ì„±í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ, **ê·¸ë˜í”½ìŠ¤, ë¬¼ë¦¬, AI ê³„ì‚° ë“± ê²Œì„ ê°œë°œì˜ ë‹¤ì–‘í•œ ìˆ˜í•™ì  ì²˜ë¦¬**ì— ì‚¬ìš©ëœë‹¤.

----  

### ğŸ“ˆ ì™œ í•„ìš”í•œê°€?

**ğŸ’¡ ê¸°ì¡´ ë²¡í„° ì§‘í•©ì˜ ë¬¸ì œì **
1. ì„ í˜• ë…ë¦½ì´ì§€ë§Œ ì„œë¡œ ì§êµí•˜ì§€ ì•ŠìŒ â†’ ê³„ì‚° ë¶ˆí¸
2. ë²¡í„° ì •ê·œí™”ê°€ í•„ìš”í•˜ì§€ë§Œ ë‹¨ìˆœ ì •ê·œí™”ë§Œìœ¼ë¡  ê¸°ì €ê°€ ì•„ë‹˜
3. ì§êµì„± + ë‹¨ìœ„ ë²¡í„° â†’ ê³„ì‚° ìµœì í™” ë° ì•ˆì •ì„± í™•ë³´

**âœ… í•´ê²°ì±…**
> **ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ê³¼ì •ì€ ì§êµì„±ê³¼ ì •ê·œí™” ë‘ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” ë²¡í„° ì§‘í•©ì„ ë§Œë“¤ì–´ ê³„ì‚° íš¨ìœ¨ì„ ë†’ì¸ë‹¤.**

----  

### ğŸ“ˆ ê³¼ì • ì„¤ëª…

ì£¼ì–´ì§„ ë²¡í„° ì§‘í•© \( \{v_1, v_2, ..., v_n\} \)ì—ì„œ ì •ê·œì§êµ ê¸°ì € \( \{u_1, u_2, ..., u_n\} \)ì„ êµ¬ì„±í•˜ëŠ” ë‹¨ê³„:

1. \( u_1 = \frac{v_1}{\|v_1\|} \)
2. \( u_2' = v_2 - \text{proj}_{u_1}(v_2) \), \( u_2 = \frac{u_2'}{\|u_2'\|} \)
3. \( u_k' = v_k - \sum_{j=1}^{k-1} \text{proj}_{u_j}(v_k) \), \( u_k = \frac{u_k'}{\|u_k'\|} \)

\( \text{proj}_{u}(v) = \frac{\langle v, u \rangle}{\langle u, u \rangle} u \)

---- 

### ğŸ“ˆ íƒ„ì  íŠ¸ ê³µê°„ì´ë€?

- **íƒ„ì  íŠ¸ ê³µê°„(Tangent Space)** ì€ **í‘œë©´ì— ë¶™ì–´ ìˆëŠ” ì¢Œí‘œê³„**
- ë³´í†µ (Tangent, Bitangent, Normal)ì˜ ì„¸ ì¶•ìœ¼ë¡œ êµ¬ì„±ë¨
- ë…¸ë©€ë§µì— ì €ì¥ëœ ë²•ì„  ì •ë³´ëŠ” ì´ ì¢Œí‘œê³„ ê¸°ì¤€ìœ¼ë¡œ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, ì´ë¥¼ **ì›”ë“œ ê³µê°„ìœ¼ë¡œ ë³€í™˜í•˜ë ¤ë©´ TBNì´ í•„ìš”**í•¨

----

### ğŸ“ˆ ê·¸ëŒ-ìŠˆë¯¸íŠ¸ì™€ íƒ„ì  íŠ¸ ê³µê°„(TBN)ì˜ ê´€ê³„

> **ì…°ì´ë”ì—ì„œ íƒ„ì  íŠ¸ ê³µê°„(Tangent Space)ì„ êµ¬ì„±í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ìˆ˜í•™ì  ì›ë¦¬ëŠ” ë°”ë¡œ 'ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ì •ê·œì§êµí™”'ì´ë‹¤!**

ìš°ë¦¬ê°€ í”íˆ HLSL ë˜ëŠ” GLSLì—ì„œ **Normal Mapping**ì„ êµ¬í˜„í•  ë•Œ ì‚¬ìš©í•˜ëŠ” TBN í–‰ë ¬(Tangent, Bitangent, Normal)ì€ ë‹¨ìˆœí•œ ë²¡í„° ì§‘í•©ì´ ì•„ë‹ˆë¼ **ì •ê·œì§êµê¸°ì €(Orthonormal Basis)**ë‹¤. ê·¸ë¦¬ê³  ì´ ê¸°ì €ëŠ” ì¢…ì¢… **ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ì •ê·œì§êµí™”(Gram-Schmidt)** ê³¼ì •ì— ì˜í•´ ë§Œë“¤ì–´ì§„ë‹¤.

----

### ğŸ“ˆ DirectX HLSL ì˜ˆì œ

```glsl
void NormalMapping(float2 uv, float3 normal, float3 tangent, SamplerState samp)
{
    float4 map = MaterialMaps[MATERIAL_TEXTURE_NORMAL].Sample(samp, uv);
    
    //Material.Diffuse = map;
    
    [flatten]
    if (any(map.rgb) == false)
        return;
    
    float3 coord = map.rgb * 2.0f - 1.0f; //-1.0f ~ +1.0f
    
    //ì„ì˜ë¡œ ê³µê°„ ë§Œë“¤ê¸°(íƒ„ì  íŠ¸ ê³µê°„) - ì¶• ë³€í™˜
    float3 N = normalize(normal); //Z
    float3 T = normalize(tangent - dot(tangent, N) * N); //X
    float3 B = cross(N, T); //Y
    
    float3x3 TBN = float3x3(T, B, N);
    coord = mul(coord, TBN);
    
    
    //Material.Diffuse = map;
    Material.Diffuse *= saturate(dot(-LightDirection, coord));
}
```

### ğŸ“ˆ ì´ ì½”ë“œì—ì„œ ì¼ì–´ë‚˜ëŠ” ì •ê·œì§êµí™”

| ë‹¨ê³„ | ì˜ë¯¸ | ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ê³¼ì •ê³¼ì˜ ì—°ê²° |
|------|------|----------------------------|
| `N = normalize(normal)` | ë‹¨ìœ„ ë²•ì„  ë²¡í„° ìƒì„± | \( u_1 = \frac{v_1}{\|v_1\|} \) |
| `T = normalize(tangent - dot(tangent, N) * N)` | Normalì— ì§êµí•œ ë²¡í„° ìƒì„± | \( u_2 = \frac{v_2 - \text{proj}_{u_1}(v_2)}{\|...\|} \) |
| `B = cross(N, T)` | Tì™€ Nì— ì§êµí•œ ë²¡í„° ìƒì„± | ì„¸ ë²ˆì§¸ ì •ê·œì§êµ ë²¡í„° êµ¬ì„± |

> ì¦‰, ì´ TBN êµ¬ì„± ê³¼ì •ì€ ì‹¤ì œë¡œëŠ” ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ì •ê·œì§êµí™”ë¥¼ **ìµœì†Œ 2ë‹¨ê³„** ì ìš©í•œ ê²°ê³¼ë¼ê³  í•  ìˆ˜ ìˆìŒ.

----

### ğŸ“ˆ TBN = ì •ê·œì§êµê¸°ì €

- ì •ê·œì§êµê¸°ì €ë€: ì„œë¡œ ìˆ˜ì§ì´ê³  ê¸¸ì´ê°€ 1ì¸ ë²¡í„° ì§‘í•©
- T, B, Nì€ ëª¨ë‘ ë‹¨ìœ„ë²¡í„°ì´ë©° ì„œë¡œ ì§êµ â†’ **ì •í™•í•œ ê³µê°„ ë³€í™˜ ê°€ëŠ¥**
- ì´ëŠ” ê·¸ëŒ-ìŠˆë¯¸íŠ¸ë¥¼ í†µí•´ **ì •ë ¬ë˜ì§€ ì•Šì€ ë²¡í„° â†’ ì •ê·œì§êµ ë²¡í„°**ë¡œ ë³€í™˜í•œ ê²ƒê³¼ ê°™ìŒ

----  

### ğŸ“ˆ í™œìš© ì‚¬ë¡€ (ê²Œì„ ê°œë°œ)

#### ğŸ® 1. ì¹´ë©”ë¼ íšŒì „
- ì‹œì•¼ ë²¡í„°ë¥¼ ì •ê·œì§êµê¸°ì €ë¡œ êµ¬ì„±í•´ ì •í™•í•œ íšŒì „ ë° ì´ë™ ì²˜ë¦¬ ê°€ëŠ¥

#### ğŸ® 2. ë¡œì»¬ ì¢Œí‘œê³„ êµ¬ì„±
- ë¬¼ì²´ì˜ ë°©í–¥, ì•/ì˜†/ìœ„ ë²¡í„°ë¥¼ ë™ì ìœ¼ë¡œ ì •ê·œì§êµí™”í•´ ì•ˆì •ì  ì œì–´

#### ğŸ® 3. AI ì‹œì•¼ ì²˜ë¦¬
- ì •ê·œì§êµ ê¸°ì €ë¡œ ì‹œì•¼ ë²¡í„° ë²”ìœ„ë¥¼ ê³„ì‚°í•˜ê±°ë‚˜ ìƒëŒ€ ìœ„ì¹˜ ì¶”ì ì— í™œìš©

----  

### ğŸ“ˆ ì¥ë‹¨ì 

| ì¥ì  | ë‹¨ì  |
|------|------|
| **ì§êµì„±ê³¼ ì •ê·œí™”ë¥¼ ë™ì‹œì— ë§Œì¡±** | ê³„ì‚°ëŸ‰ ì¦ê°€ (ë²¡í„° ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ì—°ì‚°ëŸ‰ ë§ì•„ì§) |
| **ìˆ˜í•™ì  ì•ˆì •ì„±ê³¼ ê³„ì‚° íš¨ìœ¨ í™•ë³´** | ì…ë ¥ ë²¡í„°ê°€ ì„ í˜• ë…ë¦½ì´ ì•„ë‹ ê²½ìš° ì‹¤íŒ¨ ê°€ëŠ¥ |
| **ê·¸ë˜í”½ìŠ¤, ë¬¼ë¦¬, AIì— í™œìš© ê°€ëŠ¥** | ë¶€ë™ì†Œìˆ˜ì  ì˜¤ì°¨ë¡œ ì¸í•´ ì§êµì„±ì´ ì•½ê°„ ê¹¨ì§ˆ ìˆ˜ ìˆìŒ |

----  

### ğŸ“ˆ ìµœì¢… ì •ë¦¬

> TBN í–‰ë ¬ì€ Normal Mappingì—ì„œ ë…¸ë©€ ë²¡í„°ë¥¼ ë³€í™˜í•˜ëŠ” ë° í•„ìš”í•œ ì§êµì¢Œí‘œê³„ì´ë‹¤.
ì´ TBNì„ êµ¬ì„±í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ìˆ˜í•™ì  í•µì‹¬ ì›ë¦¬ê°€ ê·¸ëŒ-ìŠˆë¯¸íŠ¸ ì •ê·œì§êµí™”ì´ë‹¤. <br>
Normal ë²¡í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ Tangentë¥¼ ì§êµí™”í•˜ê³ , ë‘˜ì˜ ì™¸ì ìœ¼ë¡œ Bitangentë¥¼ êµ¬í•´ ì •ê·œì§êµê¸°ì €ë¥¼ ì™„ì„±í•œë‹¤. <br>
ì´ ì •êµí•œ êµ¬ì„± ë•ë¶„ì— ì…°ì´ë”ì˜ ì¡°ëª…ê³¼ ë…¸ë©€ë§µ ê²°ê³¼ê°€ ì •í™•í•˜ê²Œ ê³„ì‚°ëœë‹¤. <br>

-----
<span style="color:darkgray;">ì¶œì²˜ :</span>

- [Wikipedia - Gramâ€“Schmidt process](https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process)
- [Khan Academy - ì •ê·œì§êµ ê¸°ì € ì†Œê°œ](https://ko.khanacademy.org/math/linear-algebra/alternate-bases/orthonormal-basis/v/linear-algebra-introduction-to-orthonormal-bases)
- [ë‹¤í¬í”„ë¡œê·¸ë˜ë¨¸ - ì •ê·œì§êµí™”](https://darkpgmr.tistory.com/165)
- [UE4 Documentation - FVector](https://docs.unrealengine.com/4.27/en-US/API/Runtime/Core/Math/FVector/)

